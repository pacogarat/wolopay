<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Wolopay!</title>
        
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

            <link rel="stylesheet" href="/css/1376e32_bootstrap_extra_1.css" media="screen" />
    
        <link rel="icon" type="image/x-icon" href="http://sym2_pay_gateway.dev/favicon.ico?1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    </head>
    <body>
            
    <a id="title.2"></a><h1>Getting Started</h1>
<p>It is important to understand the whole flow before trying to implement any feature from the SDK:</p>
<ul><li class="dash">Sign up to Wolopay at http://wolopay.com/</li>
<li class="dash">Inside Wolopay control panel, create as many Applications as you wish. Configure items, articles, payment methods, shops, offers, etc.</li>
<li class="dash">Download SDK</li>
<li class="dash">Integrate code as explained in this guide (including tests).</li>
<li class="dash">Send for approval.</li>
<li class="dash">Go Live</li>
</ul>

<a id="title.2.1"></a><h2>Introduction to the Document</h2>
<p>The goal of this document is to describe Catervapp SDK features and capabilities, in order to detail all steps needed to integrate a mobile APP with Catervapp in your Android application. Once integrated, Catervapp will be able to generate installs of the application and measure them, including all possible variables to optimize the traffic.
The document will detail:
SDK functionality and implementation.
Code examples
How to program a unique request that handles all the payment process</p>
<a id="title.2.2"></a><h2>Scope</h2>
<p>This document explains, from a technical point of view, the different possible interactions with Wolopay’s SDK, as well as the parameters and answers involved in those interactions. It’s therefore intended for developers who will be in charge of integrating Wolopay SDK with the payment part of their Apps.</p>
<a id="title.2.3"></a><h2>Introduction to Wolopay</h2>
<p>Wolopay is the most advanced and flexible payment solution in the market. It allows:</p>
<ul><li class="dash">Defining the “applications” of a merchant (like the games of a developer or publisher).</li>
<li class="dash">Defining one or more “items” sold in each game (gold, silver, bronze, coins, Arrows, Magic Mushroom, Mighty Sword...)</li>
<li class="dash">Defining an “article”, that is, a certain amount of items sold (so the user can’t choose the quantity). For example “10 silver coins” or “100 arrows”</li>
<li class="dash">Wolopay will allow the merchant to use certain “payment methods” to the game in each country.</li>
<li class="dash">The merchant will choose which articles are available in which “payment method”, per country, and at which price. So one article may have different prices depending on the payment method (and its commission) and even different prices for the same payment method in a different country (because of the standard of living, for example).</li>
<li class="dash">Defining offers (special price, or different amount of “items”) in a period of time (can be programmed so it starts and ends automatically)</li>
<li class="dash">Defining promotional or “gift codes”, to be redeemed (so they can be given offline, or for specific actions, like answering a poll).</li>
<li class="dash">Limiting the number of times that one user can buy an article, redeem a code, or buy an offer.</li>
<li class="dash">Defining different combinations of all the above into different “shops”, that can be used depending on the user level</li>
<li class="dash"> Etc.</li>
</ul>

<p>With Wolopay and all the above mentioned, the merchant may choose to:</p>
<ul><li class="dash">Define everything in Wolopay, and when the user wishes to buy something, call Wolopay so that the options are presented inside Wolopay System, and leave it open to the user to choose payment method and article.</li>
<li class="dash">When the user wishes to buy, he chooses the payment method (or it’s forced because it’s the only one) inside the game, and then tell Wolopay which payment method it is. In this way, the user will only be presented the articles allowed for that specific payment method. He chooses the article in Wolopay and pays.</li>
<li class="dash">When the user is going to buy, he chooses inside the game the article to be bought, then Wolopay is launched accordingly, and only the payment methods allowed for that article are shown. User chooses the payment method inside Wolopay and pays.</li>
</ul>

<p>All the combinations above are improved with the ability to the customer to choose the user is allowed to change the country where the article is bought or not.</p>
<a id="title.2.4"></a><h2>The Toolkit</h2>
<p>The last version of the SDK can be found in GitHub:
https://github.com/Wolopay/wolopay-api-php</p>
<p>Project contains</p>
<table><tr><td><strong>File or folder name</strong></td><td><strong>Explanation</strong></td></tr><tr><td>src</td><td>Contains the WolopayApi class definition file</td></tr><tr><td>src/WolopayApi.php</td><td>WolopayApi class definition</td></tr><tr><td>basic_process</td><td>Folder that contains example of basic usage</td></tr><tr><td>basic/createTransaction.php</td><td>PHP Example for creating a transaction</td></tr><tr><td>basic/notification.php</td><td>PHP Example for verifying the veracity of a notification of payment Error: No se encuentra la fuente de referencia</td></tr><tr><td>basic/index.php</td><td>PHP Example of request to the system, so that it automatically launches Wolopay interface to the user, in a &quot;lightbox&quot; on top of the current page.</td></tr><tr><td>extra_features</td><td>Folder that contains example of additional functionalities</td></tr></table>
<a id="title.3"></a><h1>Integration</h1>
<a id="title.3.1"></a><h2>Pre-Requisites</h2>
<p>During the integration phase:</p>
<ul><li class="dash">The merchant has to provide Wolopay with a Notification URL. This will be used to notify whenever there is a successful transaction.</li>
<li class="dash">Wolopay will provide the merchant with a customerId, and a private key, that will be used as part of the security mechanism explained below.</li>
</ul>

<a id="title.3.2"></a><h2>API</h2>
<p>Please check the following URL for the latest version of all methods: https://wolopay.com/api/doc/</p>
<a id="title.3.3"></a><h2>Security</h2>
<p>All requests include WSSE authentication:</p>
<pre class="php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">function</span> generateHeaderWSSE<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#123;</span>
    <span style="color: #000088;">$nonce</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/md5"><span style="color: #990000;">md5</span></a><span style="color: #009900;">&#40;</span><a href="http://www.php.net/rand"><span style="color: #990000;">rand</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span><a href="http://www.php.net/uniqid"><span style="color: #990000;">uniqid</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #000088;">$created</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/gmdate"><span style="color: #990000;">gmdate</span></a><span style="color: #009900;">&#40;</span>DATE_ISO8601<span style="color: #339933;">,</span> <a href="http://www.php.net/time"><span style="color: #990000;">time</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #000088;">$digest</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/base64_encode"><span style="color: #990000;">base64_encode</span></a><span style="color: #009900;">&#40;</span><a href="http://www.php.net/sha1"><span style="color: #990000;">sha1</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$nonce</span><span style="color: #339933;">.</span><span style="color: #000088;">$created</span><span style="color: #339933;">.</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">secret</span><span style="color: #339933;">,</span><span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #000088;">$b64nonce</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/base64_encode"><span style="color: #990000;">base64_encode</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$nonce</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #b1b100;">return</span>  <a href="http://www.php.net/sprintf"><span style="color: #990000;">sprintf</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'UsernameToken Username=&quot;%s&quot;, PasswordDigest=&quot;%s&quot;, Nonce=&quot;%s&quot;, Created=&quot;%s&quot;'</span><span style="color: #339933;">,</span>
        <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">clientId</span><span style="color: #339933;">,</span>
        <span style="color: #000088;">$digest</span><span style="color: #339933;">,</span>
        <span style="color: #000088;">$b64nonce</span><span style="color: #339933;">,</span>
        <span style="color: #000088;">$created</span>
    <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;</pre>

<p>And at the time of making the http request, include special header:
curl_setopt($ch, CURLOPT_HTTPHEADER, array('X-WSSE: '.$this-&gt;generateHeaderWSSE()));</p>
<a id="title.3.4"></a><h2>Transaction</h2>
<a id="title.3.4.1"></a><h3>Create</h3>
<p>As explained above, the first step is that the merchant creates a transaction. It is done making a request to transaction.format function using POST method, where format is one of json, xml or html, as desired to obtain the answer. Only the “gamer_id” (unique identifier of the user in the game) is mandatory.</p>
<a id="title.3.4.1.1"></a><h4>Other Parameters</h4>
<p>When creating the transaction, additionally to the mandatory parameters, an array of parameters can be passed in order to change the behavior of Wolopay (for example for pre-selecting a tab or article, to limit the articles or payment methods shown, to select your user language, etc.). Explanation of all parameters in the above mentioned url: https://wolopay.com/api/doc/
The request answers with the transaction information in the format specified in the request (json, xml, html).</p>
<a id="title.3.4.1.2"></a><h4>Response</h4>
<p>The answer to the “transaction create”will contain all the information relevant to the transaction. It’s also explained in: https://wolopay.com/api/doc/</p>
<a id="title.3.4.2"></a><h3>Status</h3>
<p>In order to check the status of a transaction, a request to transaction.format function using GET method has to be done, where format is one of json, xml or html, as desired to obtain the answer.
The only mandatory parameter is “transaction_id”</p>
<a id="title.3.4.3"></a><h3>Examples</h3>
<p>Using the files of the toolkit supplied: first, create an Object of class WolopayApi, and set up a transaction with the rest of the parameters.</p>
<pre class="php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span>
&nbsp;
<span style="color: #b1b100;">require_once</span> <span style="color: #0000ff;">&quot;vendor/autoloader.php&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// if you are using composer</span>
<span style="color: #666666; font-style: italic;">// require_once &quot;WolopayApi.php&quot;; // if you are not using composer</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;">// Variables for creating WolopayApi object</span>
<span style="color: #000088;">$apiClientId</span>     <span style="color: #339933;">=</span> <span style="color: #0000ff;">'5432'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Provided by Wolopay at integration time</span>
<span style="color: #000088;">$apiClientSecret</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'123456'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Provided by Wolopay at integration time</span>
<span style="color: #000088;">$sandbox</span>         <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #339933;">;</span>
<span style="color: #000088;">$debug</span>           <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">// Variables for creating the transaction</span>
<span style="color: #000088;">$gamerId</span>      <span style="color: #339933;">=</span> <span style="color: #0000ff;">'user132'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Unique User Id. (always the same id for that specific user)</span>
<span style="color: #000088;">$level</span>        <span style="color: #339933;">=</span> <span style="color: #0000ff;">'3'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Level of the user, as agreed with Wolopay at integration time</span>
<span style="color: #000088;">$extraOptions</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #000088;">$autoRedirect</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">// Create object</span>
<span style="color: #000088;">$wolopayApi</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> WolopayApi<span style="color: #009900;">&#40;</span><span style="color: #000088;">$apiClientId</span><span style="color: #339933;">,</span> <span style="color: #000088;">$apiClientSecret</span><span style="color: #339933;">,</span> <span style="color: #000088;">$sandbox</span><span style="color: #339933;">,</span> <span style="color: #000088;">$debug</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;</pre>

<p>Once the object is created, there are two options:</p>
<a id="title.3.4.3.1"></a><h4>Receiving Data</h4>
<p>The createTransaction method answers by default a JSON that includes the transaction Identifier and a URL that is
the one to be launched in the browser; this URL is the one that “renders” the shop for the user to select articles,
payment methods, etc., and to pay:</p>
<pre class="php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span>
&nbsp;
<span style="color: #666666; font-style: italic;">//Create transaction, and get transactionId and URL from the result.</span>
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$wolopayApi</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">createTransaction</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$gamerId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'user13'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$level</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #000088;">$result</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">id</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//  have a transactionId</span>
<a href="http://www.php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: &quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$result</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">url</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>

<a id="title.3.4.3.2"></a><h4>Auto Redirect</h4>
<p>However, the method accepts a parameter autoRedirect, which instead of the JSON, automatically redirects to the
aforementioned URL. With this option, when the method is requested, nothing else has to be done</p>
<pre class="php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span>
&nbsp;
<span style="color: #666666; font-style: italic;">//Create transaction</span>
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><span style="color: #000088;">$wolopayApi</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">createTransaction</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$gamerId</span><span style="color: #339933;">,</span> <span style="color: #000088;">$level</span><span style="color: #339933;">,</span> <span style="color: #000088;">$extraOptions</span><span style="color: #339933;">,</span> <span style="color: #000088;">$autoRedirect</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$debug</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
        <span style="color: #b1b100;">echo</span> <span style="color: #0000ff;">&quot;Error, Request can't be generated&quot;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
    <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \Exception<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Request can't be generated&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre>

<a id="title.3.4.3.3"></a><h4>Launching as an IFrame on top of the Window</h4>
<p>The recommended way of launching Wolopay is by creating a Lightbox in JavaScript that “renders” the shop on top of the current window. In this way, browsers will not treat it as a pop-up (and therefore will not block it).
Wolopay provides a JavaScript that can be included in the project in order to create the lightbox.
The following snippets of code show a working example:</p>
<pre class="html5" style="font-family:monospace;"><span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span>
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span>
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span>
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span>
    <span style="color: #808080; font-style: italic;">&lt;!-- Lightweight lightbox without jquery --&gt;</span>
    <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/script.html"><span style="color: #000000; font-weight: bold;">script</span></a> <span style="color: #000066;">src</span><span style="color: #66cc66;">=</span><span style="color: #ff0000;">&quot;\\wolopay.com/plugin/lightbox.js&quot;</span>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/script.html"><span style="color: #000000; font-weight: bold;">script</span></a>&gt;</span>
    <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/a.html"><span style="color: #000000; font-weight: bold;">a</span></a> <span style="color: #000066;">href</span><span style="color: #66cc66;">=</span><span style="color: #ff0000;">&quot;#&quot;</span> <span style="color: #000066;">onclick</span><span style="color: #66cc66;">=</span><span style="color: #ff0000;">&quot;woPlugin.open('./createTransaction.php')&quot;</span>&gt;</span>Click me to open the shop<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/a.html"><span style="color: #000000; font-weight: bold;">a</span></a>&gt;</span>
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span>
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span></pre>

<p>Being “createTransaction” a file with the 5.1 and 5.1.b code (having included WolopayApi.php with the class definition).</p>
<a id="title.4"></a><h1>Receiving Notifications</h1>
<p>When a transaction finalizes into an effective purchase, that is, the user has paid for the article (or articles if
he used the “cart”), Wolopay notifies the App accordingly, so that the user is granted the privileges bought (be it
virtual currency, months of subscription, or a physical object). One request is done per article of the cart. If
one article had a “gift”, this gift will also be notified in a separate request (as it’s, in fact, a different
article).</p>
<p>In the same way, if there’s a chargeback (payment cancellation) or a refund (whether initiated by the payment method
, whether initiated in Wolopay’s control panel), Wolopay also notifies the customer via HTTP. The parameters are
the same (except “event”, which has a different value, as explained below). Again, one request is done per article
of the original purchase. This is done for the cases in which the game has to take some action (like “removing” an
article from the user, subtracting resources, or simply log the event for accounting).</p>
<p>Wolopay will make a request to the provided URL, with parameters via POST.  Additionally, a security parameter will
be sent in the header (Authorization: Signature XXXX), this parameter will be used for checking the authenticity of
the transaction as explained below:</p>
<a id="title.4.1"></a><h2>Mandatory Parameters to receive</h2>
<table><tr><td><strong>Parameter</strong></td><td><strong>Description</strong></td></tr><tr><td>event   </td><td>Specifies if notification is of a successful transaction (payment) or of a cancellation or refund. Possible values: <strong>payment.completed</strong> OR <strong>payment.cancelled</strong>. Of course, items have to be given only when: <strong>event=payment.completed</strong></td></tr><tr><td>notificationId </td><td>Unique identifier for the notification. This parameter has to be used in order to detect duplicated requests.</td></tr><tr><td>appId </td><td>Identifier of the application. It?s mandatory only if the customer has more than one app.</td></tr><tr><td>gamerId </td><td>Unique identifier of the user that has paid (as received when creating the transaction). This parameter has to be used to identify WHO to add the article</td></tr><tr><td>itemId      </td><td>The app may have more than one item, each of them having a unique numeric identifier (for example ?coins=195?, ?months of premium account=196?, a ?welcome pack=197?, etc.). This parameter indicates the itemId that has to be added to the user (as stored in Wolopay database). It will be provided by Wolopay at integration time. Instead of this, gameItemId (see below) may be used for mapping with already existing ids in the game. So for example, the game may have an item named ?gold_coins?, and Wolopay inserted as ?195?. When creating the item, the game may specify ?gameItemId=gold_coins?. When receiving the notification, the game should use ?gameItemId?, which will contain ?gold_coins? (instead of ?itemId? that will be 195) See below</td></tr><tr><td>gameItemId  </td><td>When creating the item in the ?admin? control panel, the game can insert the name or id of the item in their side, so they can use it for identifying what to give to the user.</td></tr><tr><td>amount  </td><td>Amount of ?items? to be added to the user account.. For example, if the user selected ?100 coins?, amount=100. If that same article has a 2x1 offer, the purchase was for 200, so amount=200</td></tr></table>
<p>Too see more parameters go to </p>
<a id="title.4.2"></a><h2>Checking Authenticity of a transaction notification</h2>
<p>When receiving a notification of a successful transaction from Wolopay, a “secret” value is sent as a HEADER:</p>
<p>Authorization: Signature XXX</p>
<p>Being “XXXX” a “secret” value, obtained as a sha1 of the “query” received as POST plus the private key obtained at
integration time.</p>
<p>In order to check the authenticity of the whole request received by the App, the following procedure has to be
followed:</p>
<ul><li class="dash">Get the POST query as received (in the order it is received), and along with the “private key” provided at
integration time, get a value as follows:
    o $check = sha1($query. $privateKey)</li>
<li class="dash">Check if “secret” value received in the header equals the value obtained above ($check == $secret)</li>
<li class="dash">If they match, the request is valid.</li>
</ul>

<a id="title.4.2.1"></a><h3>Expected Answer</h3>
<p>When Wolopay makes a “notification” request expects a 200 HTTP response code as answer, ONLY if the user was
correctly added the purchased article (in fact, any code between 200 and 299).</p>
<p>In any other case, if the transaction did not finished correctly for any reason (for example, for a duplicated
transaction, user not found, database or internal errors, etc), a 200 code must NOT be answered. Any 400 – 499 code would be the preferred code.</p>
<p>If Wolopay receives any http code other than a 200, the system will automatically re-try the request every 10
minutes up to 25 times. It’s recommended that you notify yourself of this situation in order to fix it as soon as
possible.</p>
<a id="title.4.3"></a><h2>Special Cases</h2>
<a id="title.4.3.1"></a><h3>Shopping Cart</h3>
<p>Wolopay offers the end-users visiting the shop to buy multiple articles at once (except for SMS, voice and subscriptions).</p>
<p>If a user buys multiple articles in the same purchase, the game will receive one notification per article in the cart.
Each notification will have:</p>
<p>a unique id (WONOT_xxxxxxxxxxxxx) that identifies ONE article per purchase,
a transaction_id (<a href="">WOT</a> xxxxxxxxxxxxx) that identifies the “transaction”, that is, the “purchase”. So all the articles in the cart, will have the same transaction_id
the itemId and amount that has to be given to the user of the article in the notification (each notification may have different values in this parameter –or not if the user purchased more than 1 time the same article
BUT each notification will have the total price paid in the purchase, that is, the price of the whole cart (and NOT of each individual article).</p>


            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    </body>
</html>
